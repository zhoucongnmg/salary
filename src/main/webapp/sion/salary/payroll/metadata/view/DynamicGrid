{
    "type": "Ext.window.Window",
    "reference": {
        "name": "items",
        "type": "array"
    },
    "codeClass": null,
    "userConfig": {
        "container|align": "stretch",
        "designer|userClassName": "DynamicGrid",
        "height": 700,
        "layout": "vbox",
        "title": null,
        "width": 1050
    },
    "name": "MyWindow1",
    "designerId": "88cf984a-a976-4126-b677-6ef701d8331b",
    "cn": [
        {
            "type": "Ext.toolbar.Toolbar",
            "reference": {
                "name": "dockedItems",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "container|align": "middle",
                "dock": "top",
                "layout|flex": 1
            },
            "name": "MyToolbar2",
            "designerId": "45e3118a-1e46-41ab-aced-b469f860ea8e",
            "cn": [
                {
                    "type": "Ext.button.Button",
                    "reference": {
                        "name": "items",
                        "type": "array"
                    },
                    "codeClass": null,
                    "userConfig": {
                        "itemId": "saveBtn",
                        "layout|flex": null,
                        "text": "保存"
                    },
                    "name": "MyButton7",
                    "designerId": "889b141f-2e33-4325-ae06-ebf58c88e56f",
                    "cn": [
                        {
                            "type": "basiceventbinding",
                            "reference": {
                                "name": "listeners",
                                "type": "array"
                            },
                            "codeClass": null,
                            "userConfig": {
                                "fn": "onButtonClick",
                                "implHandler": [
                                    "var me = this,",
                                    "    id = me._id,",
                                    "    accountId = me._accountId,",
                                    "    namespace = me.getNamespace(),",
                                    "    mainModel = Ext.create(namespace + '.model.Main'),",
                                    "    subGrids = me.query('grid[_subGrid=true]')||[],",
                                    "    grid = me.down('#mainGrid'),",
                                    "    store = grid.getStore(),",
                                    "    data = [];",
                                    "",
                                    "Ext.Array.each(subGrids,function(subGrid,index){",
                                    "    var subStore = subGrid.getStore();",
                                    "    subStore.sync();",
                                    "});",
                                    "",
                                    "store.sync({",
                                    "    success: function(response, options){",
                                    "        Ext.Msg.alert(\"提示\", \"保存工资条成功\");",
                                    "",
                                    "    },failure: function(response, options){",
                                    "        Ext.Msg.alert(\"提示\", \"操作失败\");",
                                    "    }",
                                    "});",
                                    ""
                                ],
                                "name": "click",
                                "scope": "me"
                            },
                            "name": "onButtonClick",
                            "designerId": "4b462508-73e2-4a5f-b8db-15ee26fc6cb5"
                        }
                    ]
                },
                {
                    "type": "Ext.button.Button",
                    "reference": {
                        "name": "items",
                        "type": "array"
                    },
                    "codeClass": null,
                    "userConfig": {
                        "layout|flex": null,
                        "text": "导出"
                    },
                    "name": "MyButton1",
                    "designerId": "a53dcc14-12ae-4268-a22c-ae85909583d2",
                    "cn": [
                        {
                            "type": "basiceventbinding",
                            "reference": {
                                "name": "listeners",
                                "type": "array"
                            },
                            "codeClass": null,
                            "userConfig": {
                                "fn": "onButtonClick1",
                                "implHandler": [
                                    "var me = this,",
                                    "    id = me._id,",
                                    "    searchForm = me.down('#searchForm'),",
                                    "    opts = searchForm.getForm().getValues();",
                                    "",
                                    "Ext.Ajax.request({",
                                    "    url:'salary/payroll/saveExcelTemp',",
                                    "    method : 'POST',",
                                    "    jsonData : {",
                                    "        opts : opts",
                                    "    },",
                                    "    success: function(response){",
                                    "        var json = Ext.JSON.decode(response.responseText);",
                                    "        window.location.href = 'salary/payroll/exportItemList?id=' + id + '&optsId=' + json.message;",
                                    "    },",
                                    "    failure: function(){",
                                    "    }",
                                    "});"
                                ],
                                "name": "click",
                                "scope": "me"
                            },
                            "name": "onButtonClick1",
                            "designerId": "f2be573c-5a54-490a-be1b-b905e0d4ee7b"
                        }
                    ]
                },
                {
                    "type": "Ext.button.Button",
                    "reference": {
                        "name": "items",
                        "type": "array"
                    },
                    "codeClass": null,
                    "userConfig": {
                        "layout|flex": null,
                        "text": "生成工资条"
                    },
                    "name": "MyButton8",
                    "designerId": "a73239c1-d026-4827-94e1-9e310910d9c6",
                    "cn": [
                        {
                            "type": "basiceventbinding",
                            "reference": {
                                "name": "listeners",
                                "type": "array"
                            },
                            "codeClass": null,
                            "userConfig": {
                                "fn": "onButtonClick11",
                                "implHandler": [
                                    "var me = this,",
                                    "    id = me._id,",
                                    "    searchForm = me.down('#searchForm'),",
                                    "    opts = searchForm.getForm().getValues();",
                                    "",
                                    "Ext.Ajax.request({",
                                    "    url:'salary/payroll/saveExcelTemp',",
                                    "    method : 'POST',",
                                    "    jsonData : {",
                                    "        opts : opts",
                                    "    },",
                                    "    success: function(response){",
                                    "        var json = Ext.JSON.decode(response.responseText);",
                                    "        window.location.href = 'salary/payroll/createPayrollExcel?id=' + id + '&optsId=' + json.message;",
                                    "    },failure: function(){",
                                    "    }",
                                    "});",
                                    ""
                                ],
                                "name": "click",
                                "scope": "me"
                            },
                            "name": "onButtonClick11",
                            "designerId": "63189a81-81fa-42e0-937d-3d719b9e00c2"
                        }
                    ]
                },
                {
                    "type": "Ext.button.Button",
                    "reference": {
                        "name": "items",
                        "type": "array"
                    },
                    "codeClass": null,
                    "userConfig": {
                        "layout|flex": null,
                        "text": "关闭"
                    },
                    "name": "MyButton9",
                    "designerId": "a962bcdc-43ec-453c-a539-00e0c0c97ce8",
                    "cn": [
                        {
                            "type": "basiceventbinding",
                            "reference": {
                                "name": "listeners",
                                "type": "array"
                            },
                            "codeClass": null,
                            "userConfig": {
                                "fn": "onButtonClick111",
                                "implHandler": [
                                    "var me = this;",
                                    "me.close();"
                                ],
                                "name": "click",
                                "scope": "me"
                            },
                            "name": "onButtonClick111",
                            "designerId": "c7bf99c6-5f31-4e7c-a29c-f3ef805303e9"
                        }
                    ]
                }
            ]
        },
        {
            "type": "Ext.form.Panel",
            "reference": {
                "name": "items",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "bodyPadding": 10,
                "itemId": "payrollForm",
                "layout": "column",
                "title": null
            },
            "name": "MyForm1",
            "designerId": "283eae71-e6cd-43a8-8483-6fd6eb59270c",
            "cn": [
                {
                    "type": "Ext.form.field.Display",
                    "reference": {
                        "name": "items",
                        "type": "array"
                    },
                    "codeClass": null,
                    "userConfig": {
                        "fieldLabel": "薪资主题",
                        "labelWidth": 60,
                        "layout|columnWidth": 0.25,
                        "name": "subject",
                        "value": ""
                    },
                    "name": "MyDisplayField",
                    "designerId": "f3ed107a-fc70-407b-9487-6e428a5f549b"
                },
                {
                    "type": "Ext.form.field.Display",
                    "reference": {
                        "name": "items",
                        "type": "array"
                    },
                    "codeClass": null,
                    "userConfig": {
                        "fieldLabel": "薪资方案",
                        "labelWidth": 60,
                        "layout|columnWidth": 0.25,
                        "name": "accountName",
                        "padding": "0 0 0 20",
                        "value": ""
                    },
                    "name": "MyDisplayField1",
                    "designerId": "8e912af1-bdc2-44dd-b5c5-a983957b6c56"
                },
                {
                    "type": "Ext.form.field.Display",
                    "reference": {
                        "name": "items",
                        "type": "array"
                    },
                    "codeClass": null,
                    "userConfig": {
                        "fieldLabel": "薪资月份",
                        "labelWidth": 60,
                        "layout|columnWidth": 0.17,
                        "name": "month",
                        "padding": "0 0 0 20",
                        "value": ""
                    },
                    "name": "MyDisplayField2",
                    "designerId": "c16d64d8-611f-4569-99b2-a4c31b86c444",
                    "cn": [
                        {
                            "type": "fixedfunction",
                            "reference": {
                                "name": "items",
                                "type": "array"
                            },
                            "codeClass": null,
                            "userConfig": {
                                "designer|params": [
                                    "value",
                                    "displayField"
                                ],
                                "fn": "renderer",
                                "implHandler": [
                                    "return Ext.util.Format.date(value, 'Y年m月');"
                                ]
                            },
                            "name": "renderer",
                            "designerId": "2efe3dc8-006b-4a15-9595-d1eeea08c664"
                        }
                    ]
                },
                {
                    "type": "Ext.form.field.Display",
                    "reference": {
                        "name": "items",
                        "type": "array"
                    },
                    "codeClass": null,
                    "userConfig": {
                        "fieldLabel": "社保扣费月",
                        "labelWidth": 70,
                        "layout|columnWidth": 0.17,
                        "name": "socialCostMonth",
                        "padding": "0 0 0 20",
                        "value": ""
                    },
                    "name": "MyDisplayField3",
                    "designerId": "22cb8338-c1eb-42d6-b789-15f697d30872",
                    "cn": [
                        {
                            "type": "fixedfunction",
                            "reference": {
                                "name": "items",
                                "type": "array"
                            },
                            "codeClass": null,
                            "userConfig": {
                                "designer|params": [
                                    "value",
                                    "displayField"
                                ],
                                "fn": "renderer",
                                "implHandler": [
                                    "return Ext.util.Format.date(value, 'Y年m月');"
                                ]
                            },
                            "name": "renderer",
                            "designerId": "1e43bf32-986b-4b65-9449-896d44dc56bd"
                        }
                    ]
                },
                {
                    "type": "Ext.form.field.Display",
                    "reference": {
                        "name": "items",
                        "type": "array"
                    },
                    "codeClass": null,
                    "userConfig": {
                        "fieldLabel": "人员总数",
                        "labelWidth": 60,
                        "layout|columnWidth": 0.16,
                        "name": "persons",
                        "padding": "0 0 0 20",
                        "value": ""
                    },
                    "name": "MyDisplayField4",
                    "designerId": "e5f932f8-12be-48d3-b657-c74bb3343800",
                    "cn": [
                        {
                            "type": "fixedfunction",
                            "reference": {
                                "name": "items",
                                "type": "array"
                            },
                            "codeClass": null,
                            "userConfig": {
                                "designer|params": [
                                    "value",
                                    "displayField"
                                ],
                                "fn": "renderer",
                                "implHandler": [
                                    "return Ext.Object.getSize(value);"
                                ]
                            },
                            "name": "renderer",
                            "designerId": "d6747d1c-d67b-4d2b-870f-ff902545cc86"
                        }
                    ]
                }
            ]
        },
        {
            "type": "Ext.form.Panel",
            "reference": {
                "name": "items",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "bodyPadding": 10,
                "itemId": "searchForm",
                "layout": "column",
                "title": null
            },
            "name": "MyForm2",
            "designerId": "caa3ae8d-6b8d-4273-8564-452331a3b5d1",
            "cn": [
                {
                    "type": "Ext.form.field.Text",
                    "reference": {
                        "name": "items",
                        "type": "array"
                    },
                    "codeClass": null,
                    "userConfig": {
                        "fieldLabel": "姓名",
                        "labelWidth": 50,
                        "name": "name"
                    },
                    "name": "MyTextField3",
                    "designerId": "06b9501d-9faf-474f-b640-4b474ba7975a"
                },
                {
                    "type": "Ext.form.field.Checkbox",
                    "reference": {
                        "name": "items",
                        "type": "array"
                    },
                    "codeClass": null,
                    "userConfig": {
                        "boxLabel": "显示单位社保/公积金",
                        "fieldLabel": null,
                        "name": "showCompanySocial",
                        "padding": "0 0 0 20"
                    },
                    "name": "MyCheckbox",
                    "designerId": "62ce3ef8-4a8e-4a53-ba8a-9b33df073992"
                },
                {
                    "type": "Ext.form.field.Checkbox",
                    "reference": {
                        "name": "items",
                        "type": "array"
                    },
                    "codeClass": null,
                    "userConfig": {
                        "boxLabel": "显示个人社保/公积金",
                        "fieldLabel": null,
                        "name": "showPersonalSocial",
                        "padding": "0 0 0 10"
                    },
                    "name": "MyCheckbox1",
                    "designerId": "e3439563-0d6d-49da-ac75-b0f5e92a4760"
                },
                {
                    "type": "Ext.form.field.Checkbox",
                    "reference": {
                        "name": "items",
                        "type": "array"
                    },
                    "codeClass": null,
                    "userConfig": {
                        "boxLabel": "显示部门/职位",
                        "fieldLabel": null,
                        "name": "showDept",
                        "padding": "0 0 0 10"
                    },
                    "name": "MyCheckbox2",
                    "designerId": "cb58254b-1046-4aa2-a0d7-437d9aaefa5e"
                },
                {
                    "type": "Ext.form.field.Checkbox",
                    "reference": {
                        "name": "items",
                        "type": "array"
                    },
                    "codeClass": null,
                    "userConfig": {
                        "boxLabel": "显示身份证号",
                        "fieldLabel": null,
                        "name": "showIdCard",
                        "padding": "0 0 0 10"
                    },
                    "name": "MyCheckbox3",
                    "designerId": "3e9c26d2-cfb3-4806-bc67-a48e880b5550"
                },
                {
                    "type": "Ext.form.field.Checkbox",
                    "reference": {
                        "name": "items",
                        "type": "array"
                    },
                    "codeClass": null,
                    "userConfig": {
                        "boxLabel": "显示开户行/工资卡号",
                        "fieldLabel": null,
                        "name": "showBank",
                        "padding": "0 0 0 10"
                    },
                    "name": "MyCheckbox4",
                    "designerId": "a140a534-e87f-49f2-a8c2-450fb06e28f5"
                },
                {
                    "type": "Ext.button.Button",
                    "reference": {
                        "name": "items",
                        "type": "array"
                    },
                    "codeClass": null,
                    "userConfig": {
                        "margin": "0 0 0 20",
                        "padding": null,
                        "text": "查询"
                    },
                    "name": "MyButton10",
                    "designerId": "8b543b45-0a10-4552-aa38-66fa0406a7be",
                    "cn": [
                        {
                            "type": "basiceventbinding",
                            "reference": {
                                "name": "listeners",
                                "type": "array"
                            },
                            "codeClass": null,
                            "userConfig": {
                                "fn": "onButtonClick2",
                                "implHandler": [
                                    "var me = this,",
                                    "    searchForm = me.down('#searchForm'),",
                                    "    id = me._id,",
                                    "    record = me._record,",
                                    "    ns = me.getNamespace(),",
                                    "    simpleGrid = me.down('#simpleGrid'),",
                                    "    simpleStore = simpleGrid.getStore(),",
                                    "    mainGrid = me.down('#mainGrid'),",
                                    "    mainStore = mainGrid.getStore(),",
                                    "    form = me.down('form'),",
                                    "    values = searchForm.getForm().getValues(),",
                                    "    subGrids = me.query('grid[_subGrid=true]')||[];",
                                    "",
                                    "values.type = 'Payroll';",
                                    "me.loadData(id,mainGrid,mainStore,values);",
                                    "values.query = 'Simple';",
                                    "var levelCount = me.loadData(id,simpleGrid,simpleStore,values);",
                                    "mainGrid.getHeader().setHeight(levelCount*30);",
                                    "Ext.Array.each(subGrids,function(subGrid,index){",
                                    "    var subStore = subGrid.getStore();",
                                    "    me.loadData(id,subGrid,subStore,{",
                                    "        type : 'PayrollSub'",
                                    "    });",
                                    "    subGrid.getHeader().setHeight(levelCount*30);",
                                    "});"
                                ],
                                "name": "click",
                                "scope": "me"
                            },
                            "name": "onButtonClick2",
                            "designerId": "7e0c7cab-58d8-4813-8e78-344989e9575e"
                        }
                    ]
                }
            ]
        },
        {
            "type": "Ext.panel.Panel",
            "reference": {
                "name": "items",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "container|align": "stretch",
                "itemId": "gridPanel",
                "layout": "hbox",
                "layout|flex": 1,
                "overflowX": "auto",
                "title": null,
                "width": null
            },
            "name": "MyPanel",
            "designerId": "59dbc6a3-f2d3-4a78-aac4-90bd97e7481e",
            "cn": [
                {
                    "type": "Ext.grid.Panel",
                    "reference": {
                        "name": "items",
                        "type": "array"
                    },
                    "codeClass": null,
                    "userConfig": {
                        "autoScroll": true,
                        "emptyText": "无工资条数据",
                        "itemId": "simpleGrid",
                        "title": null,
                        "width": 200
                    },
                    "name": "MyGridPanel5",
                    "designerId": "b414e37e-3621-4b84-bf92-7d907e06e831",
                    "cn": [
                        {
                            "type": "Ext.grid.column.Column",
                            "reference": {
                                "name": "columns",
                                "type": "array"
                            },
                            "codeClass": null,
                            "userConfig": {
                                "dataIndex": "string",
                                "text": null
                            },
                            "name": "MyColumn12",
                            "designerId": "21fda949-dd3c-42e0-be5e-8c21e22b91d8"
                        },
                        {
                            "type": "Ext.grid.View",
                            "reference": {
                                "name": "viewConfig",
                                "type": "object"
                            },
                            "codeClass": null,
                            "name": "MyGridView3",
                            "designerId": "b7d74b6c-6c27-4513-96d1-ea7feb104aa2"
                        }
                    ]
                },
                {
                    "type": "Ext.grid.Panel",
                    "reference": {
                        "name": "items",
                        "type": "array"
                    },
                    "codeClass": null,
                    "userConfig": {
                        "autoScroll": null,
                        "emptyText": "无工资条数据",
                        "itemId": "mainGrid",
                        "title": null,
                        "width": 1050
                    },
                    "name": "MyGridPanel4",
                    "designerId": "d797542b-63e0-440e-9eae-e4ce7b0ea693",
                    "cn": [
                        {
                            "type": "Ext.grid.column.Column",
                            "reference": {
                                "name": "columns",
                                "type": "array"
                            },
                            "codeClass": null,
                            "userConfig": {
                                "dataIndex": "string",
                                "height": null,
                                "text": null
                            },
                            "name": "MyColumn12",
                            "designerId": "0d7fb256-86ed-4a22-944b-c85d59b23bdd"
                        },
                        {
                            "type": "Ext.grid.View",
                            "reference": {
                                "name": "viewConfig",
                                "type": "object"
                            },
                            "codeClass": null,
                            "name": "MyGridView3",
                            "designerId": "89eb3b83-9a44-4542-9492-c73a741d1fa6"
                        },
                        {
                            "type": "Ext.grid.plugin.RowEditing",
                            "reference": {
                                "name": "plugins",
                                "type": "array"
                            },
                            "codeClass": "Ext.grid.plugin.RowEditing",
                            "userConfig": {
                                "cancelBtnText": "取消",
                                "pluginId": "mainRowEditor",
                                "saveBtnText": "保存"
                            },
                            "name": "MyRowEditingPlugin",
                            "designerId": "4bedaba5-cfa1-49af-b723-0108952a6c4e",
                            "customConfigs": [
                                {
                                    "group": "(Custom Properties)",
                                    "name": "saveBtnText",
                                    "type": "string"
                                },
                                {
                                    "group": "(Custom Properties)",
                                    "name": "cancelBtnText",
                                    "type": "string"
                                }
                            ],
                            "cn": [
                                {
                                    "type": "basiceventbinding",
                                    "reference": {
                                        "name": "listeners",
                                        "type": "array"
                                    },
                                    "codeClass": null,
                                    "userConfig": {
                                        "fn": "onRowEditingEdit1",
                                        "implHandler": [
                                            "",
                                            "",
                                            "var me = this,",
                                            "    record = context.record;",
                                            "",
                                            "",
                                            "me.calculate(record,function(values){",
                                            "    for (var key in values) {",
                                            "        record.set(key,values[key]);",
                                            "    }",
                                            "});",
                                            ""
                                        ],
                                        "name": "edit",
                                        "scope": "me"
                                    },
                                    "name": "onRowEditingEdit1",
                                    "designerId": "91ebabfb-e905-4a85-8680-d77fb32441df"
                                },
                                {
                                    "type": "basiceventbinding",
                                    "reference": {
                                        "name": "listeners",
                                        "type": "array"
                                    },
                                    "codeClass": null,
                                    "userConfig": {
                                        "fn": "onRowEditingBeforeEdit",
                                        "implHandler": [
                                            "var me = this;",
                                            "return me._canEdit;"
                                        ],
                                        "name": "beforeedit",
                                        "scope": "me"
                                    },
                                    "name": "onRowEditingBeforeEdit",
                                    "designerId": "5f0132a3-94d6-423d-ba20-bbf993ab8218"
                                }
                            ]
                        }
                    ]
                }
            ]
        },
        {
            "type": "basiceventbinding",
            "reference": {
                "name": "listeners",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "fn": "onWindowBeforeRender",
                "implHandler": [
                    "var me = this,",
                    "    id = me._id,",
                    "    record = me._record,",
                    "    type = me._type,",
                    "    ns = me.getNamespace(),",
                    "    searchForm = me.down('#searchForm'),",
                    "    simpleGrid = me.down('#simpleGrid'),",
                    "    mainGrid = me.down('#mainGrid'),",
                    "    form = me.down('form'),",
                    "    saveBtn = me.down('#saveBtn'),",
                    "    simpleStore = Ext.create(ns+'.store.PayrollItem',{",
                    "        storeId : 'simplePayrollItem'",
                    "    }),",
                    "    opts = me._opts,",
                    "    store = Ext.create(ns+'.store.PayrollItem');",
                    "",
                    "saveBtn.setVisible(me._canEdit);",
                    "me.setTitle(record.get('subject'));",
                    "form.loadRecord(record);",
                    "if (type == 'Payroll') {",
                    "    var subStore = Ext.create(ns+'.store.PayrollSubStore',{",
                    "        storeId : 'dynamicPayrollSubStore'",
                    "    });",
                    "",
                    "    subStore.load({",
                    "        params : {",
                    "            payrollId : id,",
                    "        },",
                    "        callback: function(records, operation, success) {",
                    "            Ext.Array.each(records,function(r,index){",
                    "                var store = Ext.create(ns+'.store.PayrollItem',{",
                    "                    storeId : 'payrollItem-' + r.get('id')",
                    "                });",
                    "                var subGrid = me.insertGrid(r);",
                    "                me.loadData(id,subGrid,store,{",
                    "                    payrollSubId : r.getId(),",
                    "                    type : 'PayrollSub'",
                    "                });",
                    "            });",
                    "",
                    "        }",
                    "",
                    "    });",
                    "}else {",
                    "    searchForm.hide();",
                    "}",
                    "",
                    "me.loadData(id,mainGrid,store,opts);",
                    "opts.query = 'Simple';",
                    "me.loadData(id,simpleGrid,simpleStore,opts);"
                ],
                "name": "beforerender",
                "scope": "me"
            },
            "name": "onWindowBeforeRender",
            "designerId": "f24dd15c-3ec2-4170-8e3b-a6473af7a17e"
        },
        {
            "type": "basicfunction",
            "reference": {
                "name": "items",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "designer|params": [
                    "record",
                    "cb"
                ],
                "fn": "calculate",
                "implHandler": [
                    "var me = this,",
                    "    grid = me.down('grid'),",
                    "    id = me._id,",
                    "    type = me._opts.type,",
                    "    url = type=='Payroll'?'salary/payroll/calculate':'salary/payroll/calculateSub',",
                    "    accountId = me._accountId;",
                    "",
                    "Ext.Ajax.request({",
                    "    url:url,",
                    "    async : false,",
                    "    jsonData : {",
                    "        accountId : accountId,",
                    "        record : record.data",
                    "    },",
                    "    success: function(response){",
                    "        var json = Ext.JSON.decode(response.responseText);",
                    "        Ext.callback(cb,me,[json.data]);",
                    "    },failure: function(){",
                    "        Ext.Msg.alert(\"提示\", \"加载失败\");",
                    "    }",
                    "});"
                ]
            },
            "name": "calculate",
            "designerId": "a7fd39c9-aa34-4d5c-8496-394e1cc81fd1"
        },
        {
            "type": "basicfunction",
            "reference": {
                "name": "items",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "designer|params": [
                    "id",
                    "grid",
                    "store",
                    "opts"
                ],
                "fn": "loadData",
                "implHandler": [
                    "var me = this,",
                    "    gridWidth = 0,",
                    "    levelCount = 1;",
                    "Ext.Ajax.request({",
                    "    url:'salary/payroll/findItemList',",
                    "    async : false,",
                    "    jsonData : {",
                    "        id : id,",
                    "        opts : opts",
                    "    },",
                    "    success: function(response){",
                    "        store.removeAll();",
                    "        var json = Ext.JSON.decode(response.responseText);",
                    "        store.model.setFields(json.data.fields);",
                    "        store.add(json.data.data);",
                    "        grid.reconfigure(store, json.data.columns);",
                    "        me._columns = json.data.columns;",
                    "        Ext.Array.each(me._columns,function(column,index){",
                    "            if (column.columns) {",
                    "                var columnWidth = 0;",
                    "                  if (levelCount!=2) levelCount=2;",
                    "                  Ext.Array.each(column.columns,function(c_column,index){",
                    "                      if (c_column.columns) {",
                    "                          if (levelCount!=3) levelCount=3;",
                    "                          columnWidth+=c_column.columns*66;",
                    "                      }else {",
                    "                          columnWidth+=100;",
                    "                      }",
                    "                  });",
                    "                gridWidth+=columnWidth;",
                    "            }else {",
                    "                gridWidth+=100;",
                    "            }",
                    "        });",
                    "        grid.setWidth(gridWidth);",
                    "    },failure: function(){",
                    "        Ext.Msg.alert(\"提示\", \"加载失败\");",
                    "    }",
                    "});",
                    "",
                    "return levelCount;"
                ]
            },
            "name": "loadData",
            "designerId": "b6c20fda-6a89-402d-9f36-8dada5199e10"
        },
        {
            "type": "basicfunction",
            "reference": {
                "name": "items",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "designer|params": [
                    "payrollSub"
                ],
                "fn": "insertGrid",
                "implHandler": [
                    "var me = this,",
                    "    canEdit = me._canEdit,",
                    "    mainGrid = me.down('#mainGrid'),",
                    "    panel = me.down('#gridPanel'),",
                    "    grid = Ext.create(me.getNs()+'.view.PayrollSubGrid',{",
                    "        itemId : payrollSub.getId(),",
                    "        _mainGrid : mainGrid,",
                    "        _canEdit : canEdit,",
                    "        _dynamicGrid : me,",
                    "        _subGrid : true",
                    "    });",
                    "",
                    "panel.insert(1,grid);",
                    "",
                    "return grid;"
                ]
            },
            "name": "insertGrid",
            "designerId": "92e00ad4-1b35-4fc4-b658-d1516661b7a6"
        }
    ]
}